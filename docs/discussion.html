<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Discussion | Contributions to Modern Bayesian Multilevel Modeling</title>
  <meta name="description" content="8 Discussion | Contributions to Modern Bayesian Multilevel Modeling" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Discussion | Contributions to Modern Bayesian Multilevel Modeling" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="adkudson/thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Discussion | Contributions to Modern Bayesian Multilevel Modeling" />
  
  
  

<meta name="author" content="Alexander Knudson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-results.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="motivating-data.html"><a href="motivating-data.html"><i class="fa fa-check"></i><b>2</b> Background and Motivating Data</a><ul>
<li class="chapter" data-level="2.1" data-path="motivating-data.html"><a href="motivating-data.html#psycho-experiments"><i class="fa fa-check"></i><b>2.1</b> Psychometric Experiments</a></li>
<li class="chapter" data-level="2.2" data-path="motivating-data.html"><a href="motivating-data.html#toj-task"><i class="fa fa-check"></i><b>2.2</b> Temporal Order Judgment Data</a></li>
<li class="chapter" data-level="2.3" data-path="motivating-data.html"><a href="motivating-data.html#data-visualizations-and-quirks"><i class="fa fa-check"></i><b>2.3</b> Data Visualizations and Quirks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3</b> Modeling the Psychometric Function</a><ul>
<li class="chapter" data-level="3.1" data-path="background.html"><a href="background.html#methods-for-working-with-pfs"><i class="fa fa-check"></i><b>3.1</b> Methods for working with PFs</a></li>
<li class="chapter" data-level="3.2" data-path="background.html"><a href="background.html#post-model-analysis"><i class="fa fa-check"></i><b>3.2</b> Post-model Analysis</a></li>
<li class="chapter" data-level="3.3" data-path="background.html"><a href="background.html#shortcomings"><i class="fa fa-check"></i><b>3.3</b> Shortcomings</a></li>
<li class="chapter" data-level="3.4" data-path="background.html"><a href="background.html#bayesian-modeling"><i class="fa fa-check"></i><b>3.4</b> Bayesian Multilevel Modeling</a><ul>
<li class="chapter" data-level="3.4.1" data-path="background.html"><a href="background.html#bayesian-stuff"><i class="fa fa-check"></i><b>3.4.1</b> Bayesian Stuff</a></li>
<li class="chapter" data-level="3.4.2" data-path="background.html"><a href="background.html#multilevel-modeling-stuff"><i class="fa fa-check"></i><b>3.4.2</b> Multilevel Modeling Stuff</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Principled Bayesian Workflow</a><ul>
<li class="chapter" data-level="4.1" data-path="workflow.html"><a href="workflow.html#iter1"><i class="fa fa-check"></i><b>4.1</b> Iteration 1 (The Journey of a Thousand Miles Begins with a Single Step)</a><ul>
<li class="chapter" data-level="4.1.1" data-path="workflow.html"><a href="workflow.html#pre-model-pre-data"><i class="fa fa-check"></i><b>4.1.1</b> Pre-Model, Pre-Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="workflow.html"><a href="workflow.html#post-model-pre-data"><i class="fa fa-check"></i><b>4.1.2</b> Post-Model, Pre-Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="workflow.html"><a href="workflow.html#post-model-post-data"><i class="fa fa-check"></i><b>4.1.3</b> Post-Model, Post-Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="workflow.html"><a href="workflow.html#iter2"><i class="fa fa-check"></i><b>4.2</b> Iteration 2 (Electric Boogaloo)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="workflow.html"><a href="workflow.html#iter2-model-dev"><i class="fa fa-check"></i><b>4.2.1</b> Model Development</a></li>
<li class="chapter" data-level="4.2.2" data-path="workflow.html"><a href="workflow.html#iter2-sim"><i class="fa fa-check"></i><b>4.2.2</b> Simulate bayesian ensemble</a></li>
<li class="chapter" data-level="4.2.3" data-path="workflow.html"><a href="workflow.html#iter2-prior-check"><i class="fa fa-check"></i><b>4.2.3</b> Prior Checks</a></li>
<li class="chapter" data-level="4.2.4" data-path="workflow.html"><a href="workflow.html#iter2-config-algo"><i class="fa fa-check"></i><b>4.2.4</b> Configure algorithm</a></li>
<li class="chapter" data-level="4.2.5" data-path="workflow.html"><a href="workflow.html#iter2-fit-sim"><i class="fa fa-check"></i><b>4.2.5</b> Fit simulated ensemble</a></li>
<li class="chapter" data-level="4.2.6" data-path="workflow.html"><a href="workflow.html#iter2-algo-calibration"><i class="fa fa-check"></i><b>4.2.6</b> Algorithmic calibration</a></li>
<li class="chapter" data-level="4.2.7" data-path="workflow.html"><a href="workflow.html#iter2-inferential-calibration"><i class="fa fa-check"></i><b>4.2.7</b> Inferential Calibration</a></li>
<li class="chapter" data-level="4.2.8" data-path="workflow.html"><a href="workflow.html#iter2-fit-obs"><i class="fa fa-check"></i><b>4.2.8</b> Fit Observation</a></li>
<li class="chapter" data-level="4.2.9" data-path="workflow.html"><a href="workflow.html#iter2-diagnose-post"><i class="fa fa-check"></i><b>4.2.9</b> Diagnose posterior fit</a></li>
<li class="chapter" data-level="4.2.10" data-path="workflow.html"><a href="workflow.html#iter2-post-retro"><i class="fa fa-check"></i><b>4.2.10</b> Posterior retrodictive checks</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="workflow.html"><a href="workflow.html#iter3"><i class="fa fa-check"></i><b>4.3</b> Iteration 3 (The one for Me)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="workflow.html"><a href="workflow.html#iter3-model-dev"><i class="fa fa-check"></i><b>4.3.1</b> Model Development</a></li>
<li class="chapter" data-level="4.3.2" data-path="workflow.html"><a href="workflow.html#iter3-diagnose-post"><i class="fa fa-check"></i><b>4.3.2</b> Diagnose posterior fit</a></li>
<li class="chapter" data-level="4.3.3" data-path="workflow.html"><a href="workflow.html#iter3-post-retro"><i class="fa fa-check"></i><b>4.3.3</b> Posterior retrodictive checks</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="workflow.html"><a href="workflow.html#iter4"><i class="fa fa-check"></i><b>4.4</b> Iteration 4 (What’s one more?)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="workflow.html"><a href="workflow.html#iter4-conceptual"><i class="fa fa-check"></i><b>4.4.1</b> Conceptual analysis</a></li>
<li class="chapter" data-level="4.4.2" data-path="workflow.html"><a href="workflow.html#iter4-summary-stats"><i class="fa fa-check"></i><b>4.4.2</b> Construct summary statistics</a></li>
<li class="chapter" data-level="4.4.3" data-path="workflow.html"><a href="workflow.html#iter4-model-dev"><i class="fa fa-check"></i><b>4.4.3</b> Model Development</a></li>
<li class="chapter" data-level="4.4.4" data-path="workflow.html"><a href="workflow.html#iter4-fit-obs"><i class="fa fa-check"></i><b>4.4.4</b> Fit the model</a></li>
<li class="chapter" data-level="4.4.5" data-path="workflow.html"><a href="workflow.html#iter4-post-retro"><i class="fa fa-check"></i><b>4.4.5</b> Posterior retrodictive checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>5</b> Model Checking</a><ul>
<li class="chapter" data-level="5.1" data-path="model-checking.html"><a href="model-checking.html#section"><i class="fa fa-check"></i><b>5.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="predictive-inference.html"><a href="predictive-inference.html"><i class="fa fa-check"></i><b>6</b> Predictive Inference</a></li>
<li class="chapter" data-level="7" data-path="application-results.html"><a href="application-results.html"><i class="fa fa-check"></i><b>7</b> Application Results</a></li>
<li class="chapter" data-level="8" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>8</b> Discussion</a></li>
<li class="chapter" data-level="9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>9</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="supplementary-code.html"><a href="supplementary-code.html"><i class="fa fa-check"></i><b>A</b> Supplementary Code</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Contributions to Modern Bayesian Multilevel Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="discussion" class="section level1">
<h1><span class="header-section-number">8</span> Discussion</h1>
<ul>
<li><p>The history of this project</p>
<ul>
<li>Data Cleaning
<ul>
<li>Data doesn’t always come in a nice tidy format</li>
<li>Metadata came in the form of directory names</li>
<li>Additional metadata (clinical data) came from a separate excel file
<ul>
<li>Ages were provided, but not age groups</li>
</ul></li>
<li>Actual data were recorded into a Matlab file</li>
<li>Not every task had the same column data</li>
<li>Not every directory/file name was spelled correctly
<ul>
<li>Adaptation, adapat,</li>
</ul></li>
<li>Had to create a unique identifier for each subject
<ul>
<li>subjects with the same initials</li>
<li>[task, trial,] age group, gender, and initials</li>
</ul></li>
<li>Some subjects with two-letter initials, others with three, and yet others that were singly unique
<ul>
<li>JM, JM_F</li>
<li>DTF</li>
<li>IV_23_, DD_21_</li>
</ul></li>
<li>Aggregating bernoulli trials into binomial counts
<ul>
<li>Sufficient statistics</li>
</ul></li>
<li>Tidying the data
<ul>
<li>Tidy Data by Hadley Wickham</li>
<li>each row is an individual observation</li>
</ul></li>
</ul></li>
<li>Developing a model
<ul>
<li>I knew I wanted to apply Bayesian modeling techniques to the data</li>
<li>Tried using classical GLM fit first to get a baseline understanding of the data
<ul>
<li>The fact that some estimates for certain subjects failed due to complete separation reinforced my enthusiasm to employ non-classical techniques</li>
</ul></li>
<li>First model was derived from the psychometric function from Bayesian Cognitive Modeling
<ul>
<li>Used nested loops to iterate over subjects and SOA values</li>
<li>Data was messy and the model was hard to build off of</li>
</ul></li>
<li>Tried <code>bayes_glm</code> and <code>rstanarm</code></li>
<li>Moved on to multilevel modeling
<ul>
<li>“Statistical Rethinking” by McElreath was my first introduction to Bayesian multilevel modeling
<ul>
<li>His <code>rethinking</code> package is too good to be just a book package</li>
</ul></li>
<li>Tried writing my own package that generates a Stan program based on R formula syntax
<ul>
<li>didn’t fully understand the concepts of no-pooling, complete pooling, and partial pooling</li>
<li>didn’t understand fixed/random effects models</li>
<li>Was shot down quickly by some kind folks on Reddit who told me that <code>brms</code> and <code>rstanarm</code> already did what I was trying to do
<ul>
<li><code>brms</code> and <code>rstanarm</code> actually did it better, but I’m not bitter. At all…</li>
</ul></li>
<li>The fossilized remains of my attempt can be viewed on github</li>
</ul></li>
<li>Tried using <code>lme4</code>, <code>rstanarm</code>, and <code>brms</code> for random effects modeling
<ul>
<li>was still limited by the lack of control over parameterization and link functions</li>
<li>Couldn’t easily include a lapse rate parameter into these packages</li>
</ul></li>
</ul></li>
<li>Realized that parameterization can have a significant affect on the efficiency of a model and the inferential power of the estimated parameters
<ul>
<li>When fitting a classical model, there is little difference in estimating <code>a + bx</code> vs. <code>d(x - c)</code> since the latter can just be expanded as <code>-cd + dx</code> which is essentially the same as the first parameterization, but there is a practical difference in the interpretation of the parameters
<ul>
<li>The second parameterization implies that there is a dependence among the parameters that can be factored out</li>
<li>In the context of psychometric functions, there is a stronger connection between PSS and <code>c</code> and the JND and <code>d</code></li>
<li>This reparameterization made it easier to specify priors and also increased the model efficiency</li>
</ul></li>
</ul></li>
<li>Visualization and making shiny plots
<ul>
<li>For the end of STAT 629 - Intro to Bayesian Statistics with Dr. Schissler, I created an interactive graph that lets you select a subject, plot a sample of their estimated psychometric functions, and plot the marginal distributions of SOA values given a probability and probability given an SOA value</li>
</ul></li>
<li>Still issues with parameterization
<ul>
<li>Treating the condition as an indicator/dummy variable has implications on the variance of predictions</li>
<li>Using an indicator variable also introduced an interaction effect into the model that I almost did not account for</li>
<li>Switched to index/factor variables helped with model fitting, and interaction effects between factors is handled by creating a new factor that is essentially the cross-product of other factor variables
<ul>
<li>E.g. x=[a, b, c], y=[i, j] –&gt; xy=[ai, aj, bi, bj, ci, cj]</li>
</ul></li>
</ul></li>
<li>One more bout of reparameterization
<ul>
<li>To us, <span class="math inline">\(Z \sim N(0, 1^2);\quad X = 3 + 2Z\)</span> is the same as saying <span class="math inline">\(X \sim N(3, 2^2)\)</span>, but to a computer, the process of sampling from <span class="math inline">\(X\)</span> can be more difficult than sampling from <span class="math inline">\(Z\)</span></li>
<li>Hierarchical models can benefit greatly from non-centered parameterization</li>
<li>Results in more efficient exploration of the posterior, higher number of effected samples, and fewer divergent transitions</li>
</ul></li>
<li>Side quest: helped explain logistic regression to a fellow who is taking a statistical psychology course in New Zealand
<ul>
<li>He was interested in fitting a 2-AFC model in Julia, which did not provide a link function for such psychometric experiments</li>
<li>In the end of our discussion, I wrote my own N-AFC link function that can be dropped in to the <code>GLM.jl</code> package</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/adknudson/thesis/blob/master/090-discussion.Rmd",
"text": null
},
"download": ["adknudson-thesis.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
