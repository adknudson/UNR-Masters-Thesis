<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Principled Bayesian Workflow | Contributions to Modern Bayesian Multilevel Modeling</title>
  <meta name="description" content="5 Principled Bayesian Workflow | Contributions to Modern Bayesian Multilevel Modeling" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Principled Bayesian Workflow | Contributions to Modern Bayesian Multilevel Modeling" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="adkudson/thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Principled Bayesian Workflow | Contributions to Modern Bayesian Multilevel Modeling" />
  
  
  

<meta name="author" content="Alexander Knudson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-modeling.html"/>
<link rel="next" href="model-checking.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="motivating-data.html"><a href="motivating-data.html"><i class="fa fa-check"></i><b>2</b> Background and Motivating Data</a><ul>
<li class="chapter" data-level="2.1" data-path="motivating-data.html"><a href="motivating-data.html#psycho-experiments"><i class="fa fa-check"></i><b>2.1</b> Psychometric Experiments</a></li>
<li class="chapter" data-level="2.2" data-path="motivating-data.html"><a href="motivating-data.html#toj-task"><i class="fa fa-check"></i><b>2.2</b> Temporal Order Judgment Data</a></li>
<li class="chapter" data-level="2.3" data-path="motivating-data.html"><a href="motivating-data.html#data-visualizations-and-quirks"><i class="fa fa-check"></i><b>2.3</b> Data Visualizations and Quirks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3</b> Background to Modeling</a></li>
<li class="chapter" data-level="4" data-path="bayesian-modeling.html"><a href="bayesian-modeling.html"><i class="fa fa-check"></i><b>4</b> Bayesian Multilevel Modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="bayesian-modeling.html"><a href="bayesian-modeling.html#bayesian-stuff"><i class="fa fa-check"></i><b>4.1</b> Bayesian Stuff</a></li>
<li class="chapter" data-level="4.2" data-path="bayesian-modeling.html"><a href="bayesian-modeling.html#multilevel-modeling-stuff"><i class="fa fa-check"></i><b>4.2</b> Multilevel Modeling Stuff</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5</b> Principled Bayesian Workflow</a><ul>
<li class="chapter" data-level="5.1" data-path="workflow.html"><a href="workflow.html#pre-model-pre-data"><i class="fa fa-check"></i><b>5.1</b> Pre-Model, Pre-Data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="workflow.html"><a href="workflow.html#conceptual-analysis"><i class="fa fa-check"></i><b>5.1.1</b> Conceptual analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="workflow.html"><a href="workflow.html#define-observational-space"><i class="fa fa-check"></i><b>5.1.2</b> Define observational space</a></li>
<li class="chapter" data-level="5.1.3" data-path="workflow.html"><a href="workflow.html#construct-summary-statistics"><i class="fa fa-check"></i><b>5.1.3</b> Construct summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="workflow.html"><a href="workflow.html#post-model-pre-data"><i class="fa fa-check"></i><b>5.2</b> Post-Model, Pre-Data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="workflow.html"><a href="workflow.html#model-development"><i class="fa fa-check"></i><b>5.2.1</b> Model development</a></li>
<li class="chapter" data-level="5.2.2" data-path="workflow.html"><a href="workflow.html#construct-summary-functions"><i class="fa fa-check"></i><b>5.2.2</b> Construct summary functions</a></li>
<li class="chapter" data-level="5.2.3" data-path="workflow.html"><a href="workflow.html#simulate-bayesian-ensemble"><i class="fa fa-check"></i><b>5.2.3</b> Simulate bayesian ensemble</a></li>
<li class="chapter" data-level="5.2.4" data-path="workflow.html"><a href="workflow.html#prior-checks"><i class="fa fa-check"></i><b>5.2.4</b> Prior checks</a></li>
<li class="chapter" data-level="5.2.5" data-path="workflow.html"><a href="workflow.html#configure-algorithm"><i class="fa fa-check"></i><b>5.2.5</b> Configure algorithm</a></li>
<li class="chapter" data-level="5.2.6" data-path="workflow.html"><a href="workflow.html#fit-simulated-ensemble"><i class="fa fa-check"></i><b>5.2.6</b> Fit simulated ensemble</a></li>
<li class="chapter" data-level="5.2.7" data-path="workflow.html"><a href="workflow.html#algorithmic-calibration"><i class="fa fa-check"></i><b>5.2.7</b> Algorithmic calibration</a></li>
<li class="chapter" data-level="5.2.8" data-path="workflow.html"><a href="workflow.html#inferential-calibration"><i class="fa fa-check"></i><b>5.2.8</b> Inferential calibration</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="workflow.html"><a href="workflow.html#post-model-post-data"><i class="fa fa-check"></i><b>5.3</b> Post-Model, Post-Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="workflow.html"><a href="workflow.html#fit-observation"><i class="fa fa-check"></i><b>5.3.1</b> Fit observation</a></li>
<li class="chapter" data-level="5.3.2" data-path="workflow.html"><a href="workflow.html#diagnose-posterior-fit"><i class="fa fa-check"></i><b>5.3.2</b> Diagnose posterior fit</a></li>
<li class="chapter" data-level="5.3.3" data-path="workflow.html"><a href="workflow.html#posterior-retrodictive-checks"><i class="fa fa-check"></i><b>5.3.3</b> Posterior retrodictive checks</a></li>
<li class="chapter" data-level="5.3.4" data-path="workflow.html"><a href="workflow.html#celebrate"><i class="fa fa-check"></i><b>5.3.4</b> Celebrate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>6</b> Model Checking</a></li>
<li class="chapter" data-level="7" data-path="predictive-inference.html"><a href="predictive-inference.html"><i class="fa fa-check"></i><b>7</b> Predictive Inference</a></li>
<li class="chapter" data-level="8" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>8</b> Results</a></li>
<li class="chapter" data-level="9" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>9</b> Discussion</a></li>
<li class="chapter" data-level="10" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>10</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="supplementary-code.html"><a href="supplementary-code.html"><i class="fa fa-check"></i><b>A</b> Supplementary Code</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Contributions to Modern Bayesian Multilevel Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workflow" class="section level1">
<h1><span class="header-section-number">5</span> Principled Bayesian Workflow</h1>
<p>There are many great resources out there<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> for following along with an analysis of some data or problem, and much more is the abundance of tips, tricks, techniques, and testimonies to good modeling practices. The problem is that many of these prescriptions are given without context for when they are appropriate to be taken. According to <span class="citation">Betancourt (<a href="#ref-betancourt2020" role="doc-biblioref">2020</a>)</span>, this leaves “practitioners to piece together their own model building workflows from potentially incomplete or even inconsistent heuristics.” The concept of a principled workflow is that for any given problem, there is not, nor should there be, a default set of steps to take to get from data exploration to predictive inferences. Rather great consideration must be given to domain expertise and the questions that one is trying to answer with the data.</p>
<p>Since everyone asks different questions, the value of a model is not in how well it ticks the boxes of goodness-of-fit checks, but in consistent it is with domain expertise and its ability to answer the unique set of questions. Betancourt suggests answering four questions to evaluate a model by:</p>
<ol style="list-style-type: decimal">
<li>Domain Expertise Consistency - Is our model consistent with our domain expertise?</li>
<li>Computational Faithfulness - Will our computational tools be sufficient to accurately fit our posteriors?</li>
<li>Inferential Adequacy - Will our inferences provide enough information to answer our questions?</li>
<li>Model Adequacy - Is our model rich enough to capture the relevant structure of the true data generating process?</li>
</ol>
<p><br /></p>
<ul>
<li>Scope out your problem</li>
<li>Specify likelihood and priors</li>
<li>check the model with fake data</li>
<li>fit the model to the real data</li>
<li>check diagnostics</li>
<li>graph fit estimates</li>
<li>check predictive posterior</li>
<li>compare models</li>
</ul>
<div id="pre-model-pre-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Pre-Model, Pre-Data</h2>
<div id="conceptual-analysis" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Conceptual analysis</h3>
<p>What are we really trying to accomplish with this experiment? Ideally we would like to answer a grid of questions related to age, task, and temporal recalibration, and how these factors affect perceptual synchrony and temporal sensitivity</p>
</div>
<div id="define-observational-space" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Define observational space</h3>
<p>Given the concept of a psychometric experiment, we can begin to develop a formal mathematical model. The response that subjects give to a TOJ task is recorded as a zero or a one (see section <a href="motivating-data.html#toj-task">2.2</a>). The response is dependent on some temporal delay between stimuli, and the delay is small – less than one second. For the audiovisual, visual, and duration tasks, the SOA values are fixed, and multiple trials are presented for each SOA.</p>
</div>
<div id="construct-summary-statistics" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Construct summary statistics</h3>
<p>In order to effectively challenge the validity of a model, we construct a set of summary statistics that help answer questions 1 and 4. We are studying the affects of age and temporal recalibration through the PSS and JND (see section <a href="motivating-data.html#psycho-experiments">2.1</a>), and we can put reasonable thresholds on those quantities.</p>
</div>
</div>
<div id="post-model-pre-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Post-Model, Pre-Data</h2>
<div id="model-development" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Model development</h3>
<p>Now that the conceptual analysis is complete, we can construct an observational model and a complementary prior model to form a complete Bayesian model.</p>
<p>The observational space is the set of responses <span class="math inline">\(\lbrace 0, 1\rbrace\)</span> and the SOA values <span class="math inline">\(\mathbb{R}\)</span>. Additionally each experiment has a unique identifier for the task, block, and subject (e.g. <code>av-pre-M-f-DB</code>). This identifier can be broken down to yield categorical variables or identifiers for each of the three, which is useful for models that make inferences at different levels in a hierarchy.</p>
<p>As was stated in section <a href="background.html#background">3</a>, a subject’s response is the outcome of a Bernoulli trial parameterized by a probability, <span class="math inline">\(\pi\)</span>, that is dependent on the SOA value and potentially other contextual and biological factors.</p>
</div>
<div id="construct-summary-functions" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Construct summary functions</h3>
<p>NA</p>
</div>
<div id="simulate-bayesian-ensemble" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Simulate bayesian ensemble</h3>
<p>What is the purpose of this step? To make sure that the generating model coupled with the summary stats/functions yields prior estimates that are consistent with domain expertise (see <a href="workflow.html#prior-checks">5.2.4</a>).</p>
</div>
<div id="prior-checks" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Prior checks</h3>
<blockquote>
<p>If the prior predictive checks indicate con ict between the model and our domain expertise then we have to return to step four [(model development)] and refine our model.</p>
</blockquote>
</div>
<div id="configure-algorithm" class="section level3">
<h3><span class="header-section-number">5.2.5</span> Configure algorithm</h3>
<p>As a default, we will be using the <code>rethinking</code> package <span class="citation">(McElreath <a href="#ref-R-rethinking" role="doc-biblioref">2020</a>)</span> which is built on top of <code>rstan</code> <span class="citation">(Guo et al. <a href="#ref-R-rstan" role="doc-biblioref">2020</a>)</span>. The rethinking package provides a high-level interface to Stan – a C-compiled Markov chain Monte Carlo (MCMC) sampler – while still being flexible enough to specify complex Bayesian models.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="workflow.html#cb1-1"></a>m1_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">alist</span>(</span>
<span id="cb1-2"><a href="workflow.html#cb1-2"></a>  response <span class="op">~</span><span class="st"> </span><span class="kw">bernoulli_logit</span>(p),</span>
<span id="cb1-3"><a href="workflow.html#cb1-3"></a>  <span class="dt">p =</span> a <span class="op">+</span><span class="st"> </span>b <span class="op">*</span><span class="st"> </span>soa,</span>
<span id="cb1-4"><a href="workflow.html#cb1-4"></a>  </span>
<span id="cb1-5"><a href="workflow.html#cb1-5"></a>  a <span class="op">~</span><span class="st"> </span><span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb1-6"><a href="workflow.html#cb1-6"></a>  b <span class="op">~</span><span class="st"> </span><span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb1-7"><a href="workflow.html#cb1-7"></a>)</span></code></pre></div>
</div>
<div id="fit-simulated-ensemble" class="section level3">
<h3><span class="header-section-number">5.2.6</span> Fit simulated ensemble</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="workflow.html#cb2-1"></a>f1_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">ulam</span>(m1_<span class="dv">0</span>, <span class="dt">data =</span> dat, <span class="dt">chains =</span> <span class="dv">8</span>, <span class="dt">cores =</span> <span class="dv">8</span>, <span class="dt">log_lik =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="algorithmic-calibration" class="section level3">
<h3><span class="header-section-number">5.2.7</span> Algorithmic calibration</h3>
<p>Did the algorithm perform correctly? What kind of diagnostics exist for this algorithm?</p>
<ul>
<li>Using HMC
<ul>
<li><span class="math inline">\(\hat{R}\)</span></li>
<li>Divergences</li>
<li>Effective sample size</li>
<li>Tail effective sample size</li>
<li>Bulk effective sample size</li>
<li>Bayesian fraction of missing information</li>
</ul></li>
</ul>
<p>Is there anything we can tune during the fitting process that can alleviate algorithmic issues? Or is it a case of Folk Theorem, and we need to adjust the model?</p>
</div>
<div id="inferential-calibration" class="section level3">
<h3><span class="header-section-number">5.2.8</span> Inferential calibration</h3>
</div>
</div>
<div id="post-model-post-data" class="section level2">
<h2><span class="header-section-number">5.3</span> Post-Model, Post-Data</h2>
<div id="fit-observation" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Fit observation</h3>
</div>
<div id="diagnose-posterior-fit" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Diagnose posterior fit</h3>
</div>
<div id="posterior-retrodictive-checks" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Posterior retrodictive checks</h3>
</div>
<div id="celebrate" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Celebrate</h3>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-betancourt2020">
<p>Betancourt, Michael. 2020. “Towards a Principled Bayesian Workflow.” <em>Betanalpha</em>. <a href="betanalpha.github.io">betanalpha.github.io</a>.</p>
</div>
<div id="ref-R-rstan">
<p>Guo, Jiqiang, Jonah Gabry, Ben Goodrich, and Sebastian Weber. 2020. <em>Rstan: R Interface to Stan</em>.</p>
</div>
<div id="ref-R-rethinking">
<p>McElreath, Richard. 2020. <em>Rethinking: Statistical Rethinking Book Package</em>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>citation needed<a href="workflow.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/adknudson/thesis/blob/master/050-bayesian-workflow.Rmd",
"text": null
},
"download": ["adknudson-thesis.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
